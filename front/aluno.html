<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MaxFit - Sistema para treinos</title>

    <!-- CSS -->
    <link rel="stylesheet" href="estilos.css">
</head>
<body>
    <!-- Cabeçalho -->
    <header>

        <!-- Título -->
        <h1>Max Fit</h1>
        <img src="imagens/logo.png" alt="Logo Max Fit">

        <!-- Menu -->
        <nav>
            <ul>
                <li><a href="#" onclick="sair()">Sair</a></li>
            </ul>
        </nav>

    </header>

   <!-- Principal -->
<main>
  <section>
    <h2 id="boasVindas"></h2>
    <p>Área do aluno.</p>
  </section>

  <!-- Treinos do aluno -->
  <section>
    <h3>Seus Treinos</h3>
    <ul id="listaTreinos"></ul>
  </section>
</main>

<!-- Script -->
<script>
  const API_URL = "https://maxfit-v0z3.onrender.com/treinos";

  // Obter dados do LocalStorage
  const obj = localStorage.getItem("usuario");

  // Verifica se existe o LocalStorage
  if (!obj) {
    window.location.href = "index.html";
  }

  // Converter obj String para JSON
  const usuario = JSON.parse(obj);

  // Exibir mensagem de boas-vindas
  const boasVindas = document.getElementById("boasVindas");
  boasVindas.innerText = `Seja bem-vindo(a) ${usuario.nome}`;

  // Referência à lista
  const listaTreinos = document.getElementById("listaTreinos");

  // Função para carregar os treinos do aluno logado
  async function carregarTreinosAluno() {
    listaTreinos.innerHTML = "<li>Carregando...</li>";
    try {
      // Busca os treinos do aluno específico
      const resposta = await fetch(`${API_URL}?aluno=${encodeURIComponent(usuario.nome)}`);
      const treinos = await resposta.json();

      if (treinos.length === 0) {
        listaTreinos.innerHTML = "<li>Nenhum treino encontrado para você.</li>";
        return;
      }

      listaTreinos.innerHTML = "";
      treinos.forEach(treino => {
        const li = document.createElement("li");
        li.innerHTML = `
          <strong>Instrutor:</strong> ${treino.instrutor}<br>
          <strong>Descrição:</strong> ${treino.descricao}<br>
        `;
        listaTreinos.appendChild(li);
      });
    } catch (erro) {
      console.error(erro);
      listaTreinos.innerHTML = "<li>Erro ao carregar seus treinos.</li>";
    }
  }

  // Carregar treinos ao abrir a página
  carregarTreinosAluno();

  // Função para sair do sistema
  const sair = () => {
    localStorage.removeItem("usuario");
    window.location.href = "index.html";
  };
</script>

</body>
</html>